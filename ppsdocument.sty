% !TEX encoding = UTF-8 Unicode
%-------------------------------------------------------
% Author: Christian Häusler
% Email: christian.haeusler@piratenpartei.ch
%-------------------------------------------------------

\ProvidesPackage{ppsdocument}[2011/11/01 v1.0 (Christian 'Corvus' Häusler)]

\RequirePackage{ppsbasic}

% -----------------------------------
% Schrift und Absatz
% -----------------------------------
\setkomafont{pagefoot}{\upshape}
\setkomafont{pagehead}{\upshape}
\setkomafont{sectioning}{\bfseries}

\KOMAoptions{fontsize=11pt}

% -----------------------------------
% Grafiken
% -----------------------------------
\AddToShipoutPicture{\wellen}

% -----------------------------------
% Kopf- und fusszeile
% -----------------------------------
\RequirePackage[automark]{scrpage2}
\KOMAoptions{headinclude=true}
\KOMAoptions{footinclude=false}
\KOMAoptions{headlines=3}
\KOMAoptions{pagesize}
\recalctypearea

\clearscrheadfoot
\pagestyle{scrheadings}

\setlength{\marginparwidth}{2.1em}
\setheadwidth[0pt]{textwithmarginpar}

\ihead[\smalllogost]{\smalllogost}


\newcommand{\rheaderplain}{
	\raisebox{0em}{
		\begin{tabular}[t]{rp{\marginparwidth-0.7em}}
			\scriptsize & \\
			\textbf{\@title}   & \hfill \pagemark\\
			\hline
		\end{tabular}
	}
}

\newcommand{\lheaderplain}{
	\raisebox{0em}{
		\begin{tabular}[t]{p{\marginparwidth-1em}l}
			& \scriptsize \\
			\raisebox{0em}{\pagemark} & \textbf{\@title}   \\
			\hline
		\end{tabular}
	}
}

\newcommand{\rheadermark}{
	\raisebox{0em}{
		\begin{tabular}[t]{rp{\marginparwidth-0.7em}}
			\textbf{\@title} & \\
			\scriptsize \headmark & \hfill\pagemark\\
			\hline
		\end{tabular}
	}
}

\newcommand{\lheadermark}{
	\raisebox{0em}{
		\begin{tabular}[t]{p{\marginparwidth-1em}l}
			& \textbf{\@title} \\
			\raisebox{0em}{\pagemark} & \scriptsize \headmark \\
			\hline
		\end{tabular}
	}
}

\rohead[\rheaderplain]{\if@chapter\rheadermark\else\rheaderplain\fi}
\lehead[\lheaderplain]{\if@chapter\lheadermark\else\lheaderplain\fi}
\ifoot[%
	\scriptsize \ppsnamelong { }| \@author { }| \@date%
]{%
	\scriptsize \ppsnamelong { }| \@author { }| \@date%
}


\deftripstyle{title}{\headerlogo}{}{}{}{}{}


\renewenvironment{titlepage}{
	\ClearShipoutPicture
	\AddToShipoutPicture*{
		\begin{tikzpicture}
			\draw (0,0) -- (0,0);
			\draw [color=orange, fill=orange](\ta@bcor+1cm,1cm) rectangle (\paperwidth-1cm,\paperheight-1cm);
		\end{tikzpicture}}
}{
	\begin{flushright}
		\vfill\biglogonego
	\end{flushright}
	\thispagestyle{empty}
	\newpage
	\AddToShipoutPicture{\wellen}
}

% \renewcommand{\maketitle}{
% 	\thispagestyle{title}
% 	\if@titlepage\vspace*{\tpagemargin}\else\fi
% 	\begin{flushright}
% 	{\Huge\ppsname\par\large\@title}
% 	\par
% 	\vspace{3em}{\raggedleft\scriptsize\@author\hspace{1em}\@date}
% 	\end{flushright}
% 	\vspace{2em}
% }

\renewcommand*\maketitle[1][1]{%
  \if@titlepage
    \begin{titlepage}
      \setcounter{page}{%
        #1%
      }%
      \let\footnotesize\small
      \let\footnoterule\relax
      \let\footnote\thanks
      \renewcommand*\thefootnote{\@fnsymbol\c@footnote}%
      \let\@oldmakefnmark\@makefnmark
      \renewcommand*{\@makefnmark}{\rlap\@oldmakefnmark}%
      \ifx\@extratitle\@empty \else
        \noindent\@extratitle\next@tpage\cleardoubleemptypage
        \thispagestyle{empty}%
      \fi
      \setparsizes{\z@}{\z@}{\z@\@plus 1fil}\par@updaterelative
      \ifx\@titlehead\@empty \else
        \begin{minipage}[t]{\textwidth}%
        \@titlehead
        \end{minipage}\par
      \fi
      \null\vfill
      \begin{flushright}
        \ifx\@subject\@empty \else
          {\subject@font \@subject \par}%
          \vskip 3em
        \fi
        {\Huge\ppsname\par\vskip .2em\titlefont\large\@title\par}%
        \vskip 1em
        {\ifx\@subtitle\@empty\else\usekomafont{subtitle}\@subtitle\par\fi}%
        \vskip 2em
        {\scriptsize\@author\hspace{1em}\@date}%
        \vskip \z@ \@plus3fill
        {\scriptsize \@publishers \par}%
        \vskip 3em
      \end{flushright}\par
      \@thanks
      \vfill\null
      \if@twoside\next@tpage
        \begin{minipage}[t]{\textwidth}
          \@uppertitleback
        \end{minipage}\par
        \vfill
        \begin{minipage}[b]{\textwidth}
          \@lowertitleback
        \end{minipage}
      \fi
      \ifx\@dedication\@empty \else
        \next@tpage\null\vfill
        {\centering \Large \@dedication \par}%
        \vskip \z@ \@plus3fill
        \if@twoside \next@tpage\cleardoubleemptypage \fi
      \fi
    \end{titlepage}
  \else
    \par
    \@tempcnta=%
    #1%
    \relax\ifnum\@tempcnta=1\else
      \ClassWarning{\KOMAClassName}{%
        Optional argument of \string\maketitle\space ignored
        at\MessageBreak
        notitlepage-mode%
      }%
    \fi
    \begingroup
      \renewcommand*\thefootnote{\@fnsymbol\c@footnote}%
      \let\@oldmakefnmark\@makefnmark
      \renewcommand*{\@makefnmark}{\rlap\@oldmakefnmark}
      \if@twocolumn
        \ifnum \col@number=\@ne
					\@maketitle
        \else
          \twocolumn[\@maketitle]%
        \fi
      \else
        \newpage
        \global\@topnum\z@
        \@maketitle
      \fi
      \thispagestyle{\titlepagestyle}\@thanks
    \endgroup
  \fi
  \setcounter{footnote}{0}%
  \let\thanks\relax
  \let\maketitle\relax
  \let\@maketitle\relax
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\@date\@empty
  \global\let\@title\@empty
  \global\let\@subtitle\@empty
  \global\let\@extratitle\@empty
  \global\let\@titlehead\@empty
  \global\let\@subject\@empty
  \global\let\@publishers\@empty
  \global\let\@uppertitleback\@empty
  \global\let\@lowertitleback\@empty
  \global\let\@dedication\@empty
  \global\let\author\relax
  \global\let\title\relax
  \global\let\extratitle\relax
  \global\let\titlehead\relax
  \global\let\subject\relax
  \global\let\publishers\relax
  \global\let\uppertitleback\relax
  \global\let\lowertitleback\relax
  \global\let\dedication\relax
  \global\let\date\relax
  \global\let\and\relax
}%

\renewcommand*{\@maketitle}{%
  \clearpage
  \let\footnote\thanks
  \ifx\@extratitle\@empty \else
    \noindent\@extratitle \next@tpage \if@twoside \null\next@tpage \fi
  \fi
  \setparsizes{\z@}{\z@}{\z@\@plus 1fil}\par@updaterelative
  \ifx\@titlehead\@empty \else
    \begin{minipage}[t]{\textwidth}
      \@titlehead
    \end{minipage}\par
  \fi
  \null
  \vskip 2em%
  \begin{flushright}%
    \ifx\@subject\@empty \else
      {\subject@font \@subject \par}
      \vskip 1.5em
    \fi
    {\Huge\ppsname\par\vskip .2em\titlefont\large\@title\par}%
    \vskip .2em
    {\ifx\@subtitle\@empty\else\usekomafont{subtitle}\@subtitle\par\fi}%
    \vskip 1em
    {\scriptsize\@author\hspace{1em}\@date}%
    \vskip \z@ \@plus 1em
    {\scriptsize \@publishers \par}
    \ifx\@dedication\@empty \else
      \vskip 2em
      {\Large \@dedication \par}
    \fi
  \end{flushright}%
  \par
  \vskip 2em
}%

\newcommand{\backgrounddefault}{}

\newcommand{\backgroundorange}{}

\newcommand{\backgroundgrey}{}

\newcommand{\backgroundviolet}{}

\backgrounddefault
